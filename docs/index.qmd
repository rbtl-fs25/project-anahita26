---
title: "Clothing Purchasing and Disposal Habits of ETH Zurich Members"
date: today
author:
  - name: Anahita Darvish
    orcid: 0000-0003-2196-5015
    email: me@web.org
    affiliation: 
      - name: ETH Zurich
        url: https://ethz.ch/de.html
format:
  html:
    embed-resources: true
    toc: true
execute:
  warning: false
editor_options: 
  chunk_output_type: console
bibliography: references.bib
editor: visual
---

# Introduction

# Methods

# Results

Summary table with statistics

```{r}
#| label: tbl-stats
#| tbl-cap: Summary Statistics of Key Survey Variables

library(tidyverse)
library(gt)

# Ensure relevant columns are numeric
data_clean <- data |> 
  mutate(across(c(new_items, env_conscious, second_hand), as.numeric))

# Compute summary statistics
summary_table <- data_clean |> 
  summarise(
    Mean = c(mean(new_items, na.rm = TRUE),
             mean(env_conscious, na.rm = TRUE),
             mean(second_hand, na.rm = TRUE)),
    
    Median = c(median(new_items, na.rm = TRUE),
               median(env_conscious, na.rm = TRUE),
               median(second_hand, na.rm = TRUE)),
    
    SD = c(sd(new_items, na.rm = TRUE),
           sd(env_conscious, na.rm = TRUE),
           sd(second_hand, na.rm = TRUE)),
    
    Min = c(min(new_items, na.rm = TRUE),
            min(env_conscious, na.rm = TRUE),
            min(second_hand, na.rm = TRUE)),
    
    Max = c(max(new_items, na.rm = TRUE),
            max(env_conscious, na.rm = TRUE),
            max(second_hand, na.rm = TRUE))
  ) |> 
  mutate(Variable = c("New Items Purchased", "Environmental Consciousness", "Percent Second-Hand Purchases")) |> 
  select(Variable, everything())

# Display using gt
summary_table |> 
  gt() |> 
  fmt_number(columns = where(is.numeric), decimals = 2)


```

```         
```

Data visualization of purchasing habits by income level

```{r}
#| label: fig-income
#| fig-cap: Purchasing Habits by Income Level

library(tidyverse)
library(ggplot2)
library(ggthemes)

data <-  read_csv("data/processed/cloting_data_cleaned.csv")

# Reshape purchasing method columns
purchasing_long <- data |> 
  pivot_longer(cols = starts_with("get_"),
               names_to = "method",
               values_to = "response") |> 
  filter(response == "yes")

# Clean method labels
purchasing_long$method <- purchasing_long$method |> 
  str_replace("get_", "") |> 
  str_replace_all("_", " ") |> 
  str_to_title()

# Plot
ggplot(data = purchasing_long, 
       mapping = aes(x = income,
                     fill = method)) +
  geom_bar(position = "fill")+
  scale_y_continuous(labels = scales::percent) +
  labs(x = "Income (CHF/month)",
       y = "Proportion of Respondents",
       fill = "Acquisition Method")+
  theme_minimal()

```

Data visualization for disposal habits by gender

```{r}
#| label: fig-gender
#| fig-cap: Disposal Habits by Gender

# Reshape disposal method columns to long format
disposal_long <- data |> 
  pivot_longer(cols = starts_with("disposal_"),
               names_to = "method",
               values_to = "response") |> 
  filter(response == "yes")

# Clean method labels
disposal_long$method <- disposal_long$method |> 
  str_replace("disposal_", "") |> 
  str_replace_all("_", " ") |> 
  str_to_title()

# Plot
ggplot(disposal_long,
       mapping = aes(x = gender,
                     fill = method)) +
  geom_bar(position = "dodge") +
  labs(x = "Disposal Method",
       y = "Number of Respondents",
       fill = "Gender") +
  theme_minimal() 
```

```{r}
# Create data frame with each disposal method and initialize percentage
disposal_habits_df <- data.frame(
  disposal_method = c("Donate", "Flea Market", "Family & Friends",
                      "Sell Online", "Recyling Bins", "Regular Trash", 
                      "Third Party Textile Recycling"),
  disposal_percentages = numeric(7)
)

# Calculate percentage of respondent's disposal habits and assign to correct place in data frame
disposal_habits_df[1, "disposal_percentages"] <- sum(data$disposal_thrift == "yes") / count(data) * 100
disposal_habits_df[2, "disposal_percentages"] <- sum(data$disposal_flea_market == "yes") / count(data) * 100
disposal_habits_df[3, "disposal_percentages"] <- sum(data$disposal_fam_friends == "yes") / count(data) * 100
disposal_habits_df[4, "disposal_percentages"] <- sum(data$disposal_sell_online == "yes") / count(data) * 100
disposal_habits_df[5, "disposal_percentages"] <- sum(data$disposal_recycling_bins == "yes") / count(data) * 100
disposal_habits_df[6, "disposal_percentages"] <- sum(data$disposal_trash == "yes") / count(data) * 100
disposal_habits_df[7, "disposal_percentages"] <- sum(data$disposal_textile_center == "yes") / count(data) * 100

```

```{r}
# Create data frame with each purchasing method and initialize percentage
purchasing_habits_df <- data.frame(
  purchasing_method = c("Thrift", "Hand-me-downs", "Clothing Swaps",
                      "Gifts", "Make Clothing"),
  purchasing_percentages = numeric(5)
)

# Calculate percentage of respondent's purchasing habits and assign to correct place in data frame
purchasing_habits_df[1, "purchasing_percentages"] <- sum(data$get_thrift == "yes") / count(data) * 100
purchasing_habits_df[2, "purchasing_percentages"] <- sum(data$get_hand_me_down == "yes") / count(data) * 100
purchasing_habits_df[3, "purchasing_percentages"] <- sum(data$get_swaps == "yes") / count(data) * 100
purchasing_habits_df[4, "purchasing_percentages"] <- sum(data$get_gifts == "yes") / count(data) * 100
purchasing_habits_df[5, "purchasing_percentages"] <- sum(data$get_make_clothes == "yes") / count(data) * 100
```

```{r}
# Calculate how many respondents purchase new clothes 
brand_sust_filtered <- data |> 
  filter(!is.na(brand_sust))

new_clothes_df <- data.frame(
  buyers_percentage = numeric(1),
  brand_sust_percentage = numeric(1))

new_clothes_df[1, "buyers_percentage"] <- sum(data$new_clothes == "yes") / count(data) * 100
new_clothes_df[1, "brand_sust_percentage"] <-  sum(brand_sust_filtered$brand_sust == "yes") / count(brand_sust_filtered) * 100
```

```{r}
# Mean percentage of second hand clothing purchases
second_hand_purchases_percentage <- mean(data$second_hand)

data |> 
  count(motivation)

data |> 
  count(disposal)

data |> 
  count(disposal_reason)
```

# Conclusion

```{r}

```
